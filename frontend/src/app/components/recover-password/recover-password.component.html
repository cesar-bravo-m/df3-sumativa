<div class="recover-container">
  <div class="recover-card">
    <h2>Recuperar Contraseña</h2>

    <!-- Username Step -->
    <form *ngIf="currentStep === 'username'" [formGroup]="recoverForm" (ngSubmit)="onSubmitUsername()" class="recover-form">
      <div class="form-group">
        <label for="username">Nombre de usuario</label>
        <input
          type="text"
          id="username"
          formControlName="username"
          placeholder="Ingresa tu nombre de usuario"
          class="form-control"
        >
        <div class="error" *ngIf="recoverForm.get('username')?.touched && recoverForm.get('username')?.errors?.['required']">
          El nombre de usuario es requerido
        </div>
      </div>

      <div class="error-message" *ngIf="errorMessage">
        {{ errorMessage }}
      </div>

      <button type="submit" class="submit-btn" [disabled]="!recoverForm.valid">
        Continuar
      </button>
    </form>

    <!-- Verification Step -->
    <form *ngIf="currentStep === 'verification'" [formGroup]="verificationForm" (ngSubmit)="onSubmitVerification()" class="recover-form">
      <div class="form-group">
        <label for="code">Código de verificación</label>
        <input
          type="text"
          id="code"
          formControlName="code"
          placeholder="Ingresa el código de verificación (000)"
          class="form-control"
        >
        <div class="error" *ngIf="verificationForm.get('code')?.touched && verificationForm.get('code')?.errors?.['required']">
          El código de verificación es requerido
        </div>
        <div class="error" *ngIf="verificationForm.get('code')?.touched && verificationForm.get('code')?.errors?.['pattern']">
          Código de verificación inválido
        </div>
      </div>

      <button type="submit" class="submit-btn" [disabled]="!verificationForm.valid">
        Verificar
      </button>
    </form>

    <!-- New Password Step -->
    <form *ngIf="currentStep === 'newPassword'" [formGroup]="newPasswordForm" (ngSubmit)="onSubmitNewPassword()" class="recover-form">
      <div class="form-group">
        <label for="password">Nueva Contraseña</label>
        <input
          type="password"
          id="password"
          formControlName="password"
          placeholder="Ingresa la nueva contraseña"
          class="form-control"
        >
        <div class="password-requirements" *ngIf="newPasswordForm.get('password')?.touched">
          <div class="error" *ngFor="let error of getPasswordErrors()">
            {{ error }}
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="confirmPassword">Confirmar Nueva Contraseña</label>
        <input
          type="password"
          id="confirmPassword"
          formControlName="confirmPassword"
          placeholder="Confirma la nueva contraseña"
          class="form-control"
        >
        <div class="error" *ngIf="newPasswordForm.get('confirmPassword')?.touched && newPasswordForm.errors?.['mismatch']">
          Las contraseñas no coinciden
        </div>
      </div>

      <div class="error-message" *ngIf="errorMessage">
        {{ errorMessage }}
      </div>

      <button type="submit" class="submit-btn" [disabled]="!newPasswordForm.valid">
        Actualizar Contraseña
      </button>
    </form>

    <div class="links">
      <a routerLink="/login">Volver al inicio de sesión</a>
    </div>
  </div>
</div>
